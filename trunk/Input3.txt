LOADER	START	100H
		
H_RECORD	TD	INPUT
	JEQ	GETNUM
	LDA	ZERO
	RD	INPUT
	COMP	SPACE
	JEQ	START_ADDRESS
	J	H_RECORD
		
START_ADDRESS	LDX	ZERO
	STX	TEMP
JUMP1	JSUB	GETNUM
	ADD	TEMP
	TIX	SIX
	JEQ	MEASURE_LENGTH
	MUL	SIXTEEN
	STA	TEMP
	J	JUMP1
		
MEASURE_LENGTH	STA	STARTADDR
	LDX	ZERO
	STX	TEMP
JUMP2	JSUB	GETNUM
	ADD	TEMP
	TIX	SIX
	JEQ	SAVE_LENGTH
	MUL	SIXTEEN
	STA	TEMP
	J	JUMP2
		
SAVE_LENGTH	STA	LENGTH
		
T_RECORD	TD	INPUT
	JEQ	T_RECORD
	LDA	ZERO
	RD	INPUT
	COMP	TCHAR
	JEQ	PUT_ADDRESS
	COMP	ECHAR
	JEQ	E_RECORD
	J	T_RECORD
		
PUT_ADDRESS	LDX	ZERO
	STX	TEMP
JUMP3	JSUB	GETNUM
	ADD	TEMP
	TIX	SIX
	JEQ	COUNT_BYTE
	MUL	SIXTEEN
	STA	TEMP
	J	JUMP3
		
COUNT_BYTE	STA	PUTADDR
	JSUB	GETNUM
	MUL	SIXTEEN
	STA	TEMP
	JSUB	GETNUM
	ADD	TEMP
	STA	NUMLOOP
		
	ADD	PUTADDR
	STA	COMPADDR
	LDX	PUTADDR
LOOP	JSUB	GETNUM
	MUL	SIXTEEN
	STA	TEMP
	JSUB	GETNUM
	ADD	TEMP
	STCH	0,X
	TIX	COMPADDR
	JEQ	T_RECORD
	J	LOOP
		
		
E_RECORD	LDX	ZERO
	STX	TEMP
JUMP4	JSUB	GETNUM
	ADD	TEMP
	TIX	SIX
	JEQ	EXIT
	MUL	SIXTEEN
	STA	TEMP
	J	JUMP4

GETNUM	TD	INPUT
	JEQ	GETNUM
	LDA	ZERO
	RD	INPUT
	SUB	ZEROCHAR
	COMP	TEN
	JLT	GTNINE
	SUB	SEVEN
GTNINE	RSUB	

INPUT	BYTE	X'F1'
ZERO	WORD	0
EOH	WORD	10
SPACE	WORD	32
ZEROCHAR	WORD	48
SEVEN	WORD	7
SIX	WORD	6
TEN	WORD	10
SIXTEEN	WORD	16
TCHAR	WORD	84
TWO	WORD	2
ECHAR	WORD	69
STARTADDR	RESW	1
LENGTH	RESW	1
TEMP	RESW	1
PUTADDR	RESW	1
NUMLOOP	RESW	1
COMPADDR	RESW	1
GOTO	RESW	1
		
EXIT	STA	GOTO
	LDL	GOTO
	RSUB	
	END	H_RECORD
